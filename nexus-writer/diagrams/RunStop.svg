<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="796" height="906"><desc>title%20Nexus%20Writer%3A%20On%20RunStop%20Message%0A%0Aparticipant%20Broker%0Aparticipant%20Nexus%20Writer%0Aparticipant%20Run%0Aparticipant%20Run%20Cache%0Aparticipant%20HDF5%20File%0A%0A%20%20Broker-%3ENexus%20Writer%3ARunStop%20message%0A%20%20Broker%3C--Nexus%20Writer%3ACommit%20message%0A%20%20Nexus%20Writer-%3ERun%20Cache%3A%20Get%20optional%20latest%20run%0A%20%20Nexus%20Writer%3C--Run%20Cache%3A%20Optional%20latest%20run%20(mut%20ref)%0A%20%20alt%20If%20latest%20run%20exists%20and%20has%20no%20stop%20time%0A%20%20%20%20Nexus%20Writer-%3E*Run%3AUpdate%20run%0A%20%20%20%20note%20over%20Run%3ASet%20stop%20time%20to%20message%20stop%20time%0A%20%20%20%20note%20over%20Run%3AUpdate%20%22%22last-modified%3Dnow%22%22%0A%20%20%20%20Run-%3E*HDF5%20File%3A%20Stop%20Run%20Command%0A%20%20%20%20destroysilent%20Run%0A%20%20%20%20note%20over%20HDF5%20File%3ASet%20End%20Time%0A%20%20%20%20destroyafter%20HDF5%20File%0A%20%20else%20else%0A%20%20%20%20Nexus%20Writer-%3ENexus%20Writer%3A%20Write%20error%20to%20log%20and%20continue%0A%20%20end%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="796" height="906"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="220.79369950984176" y="24.50280495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Nexus Writer: On RunStop Message</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 47.48040092923048 95.887643371 L 47.48040092923048 906.7671351829999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 211.64935675885286 95.887643371 L 211.64935675885286 906.7671351829999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 438.5262761063789 402.49940931199995 L 438.5262761063789 598.031792813" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 584.0441575546015 95.887643371 L 584.0441575546015 906.7671351829999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 705.4867327895273 598.031792813 L 705.4867327895273 699.310053273" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.782594461 L 86.79320020846095 51.782594461 L 86.79320020846095 95.887643371 L 8.167601650000002 95.887643371 L 8.167601650000002 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.891297230500008" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Broker</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 151.7030583341146 51.782594461 L 271.59565518359113 51.782594461 L 271.59565518359113 95.887643371 L 151.7030583341146 95.887643371 L 151.7030583341146 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="169.42675391461458" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Nexus Writer</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 529.6490294789843 51.782594461 L 638.4392856302187 51.782594461 L 638.4392856302187 95.887643371 L 529.6490294789843 95.887643371 L 529.6490294789843 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.3727250594843" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Run Cache</text></g></g><g><g><g><rect fill="white" stroke="none" x="66.81039150089713" y="128.558049971" width="125.50897468628906" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="69.26067199589713" y="143.259732941" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RunStop message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 47.48040092923048 149.793814261 L 198.20003937518618 149.793814261" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(211.64935675885286,149.793814261) translate(-211.64935675885286,-149.793814261)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 198.03668734218618 142.98747955266666 L 211.64935675885286 149.793814261 L 198.03668734218618 156.60014896933333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="70.08884151310416" y="174.296619211" width="118.952074661875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="72.53912200810416" y="188.99830218099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Commit message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 211.64935675885286 195.532383501 L 60.929718312897144 195.532383501" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(47.48040092923048,195.532383501) translate(-47.48040092923048,-195.532383501)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 61.09307034589715 188.72604879266666 L 47.48040092923048 195.532383501 L 61.09307034589715 202.33871820933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="323.6821135635827" y="220.035188451" width="148.32928718628906" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="326.1323940585827" y="234.736871421" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Get optional latest run</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 211.64935675885286 241.270952741 L 570.5948401709348 241.270952741" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(584.0441575546015,241.270952741) translate(-584.0441575546015,-241.270952741)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 570.4314881379348 234.46461803266666 L 584.0441575546015 241.270952741 L 570.4314881379348 248.07728744933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="306.1803359146569" y="265.77375769099996" width="183.33284248414063" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="308.6306164096569" y="280.47544066099994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Optional latest run (mut ref)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 584.0441575546015 287.009521981 L 225.09867414251954 287.009521981" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(211.64935675885286,287.009521981) translate(-211.64935675885286,-287.009521981)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 225.26202617551954 280.20318727266664 L 211.64935675885286 287.009521981 L 225.26202617551954 293.8158566893333 Z"/></g></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 407.3559099936523 357.0058681215 L 469.6966422191054 357.0058681215 L 469.6966422191054 401.1109170315 L 407.3559099936523 401.1109170315 L 407.3559099936523 357.0058681215 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="425.0796055741523" y="384.7757137315" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Run</text></g><g><g><rect fill="white" stroke="none" x="270.78536221963145" y="357.82262828649993" width="77.43454231324219" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="273.23564271463147" y="372.5243112564999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Update run</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 211.64935675885286 379.05839257649995 L 393.90659260998564 379.05839257649995" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(407.3559099936523,379.05839257649995) translate(-407.3559099936523,-379.05839257649995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 393.7432405769856 372.2520578681666 L 407.3559099936523 379.05839257649995 L 393.7432405769856 385.8647272848333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 301.17599630815624 427.00221426199994 L 561.1748729346016 427.00221426199994 L 575.8765559046016 441.7038972319999 L 575.8765559046016 464.57318185199995 L 301.17599630815624 464.57318185199995 L 301.17599630815624 427.00221426199994 M 561.1748729346016 427.00221426199994 L 561.1748729346016 441.7038972319999 L 575.8765559046016 441.7038972319999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="324.0452809281562" y="449.8714988819999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set stop time to message stop time</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 321.4729781196797 489.075986802 L 540.8778911230781 489.075986802 L 555.5795740930781 503.77766977199997 L 555.5795740930781 526.646954392 L 321.4729781196797 526.646954392 L 321.4729781196797 489.075986802 M 540.8778911230781 489.075986802 L 540.8778911230781 503.77766977199997 L 555.5795740930781 503.77766977199997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="344.34226273967965" y="511.94527142199996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Update </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="395.6879963822578" y="511.94527142199996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">last-modified=now</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 654.7744889302187 552.5382516225 L 756.1989766488359 552.5382516225 L 756.1989766488359 596.6433005325 L 654.7744889302187 596.6433005325 L 654.7744889302187 552.5382516225 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="672.4981845107187" y="580.3080972325" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">HDF5 File</text></g><g><g><rect fill="white" stroke="none" x="477.78994577329877" y="553.3550117875001" width="137.72087349" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="480.2402262682988" y="568.0566947575" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Stop Run Command</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 438.5262761063789 574.5907760775001 L 641.325171546552 574.5907760775001" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(654.7744889302187,574.5907760775001) translate(-654.7744889302187,-574.5907760775001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 641.161819513552 567.7844413691668 L 654.7744889302187 574.5907760775001 L 641.161819513552 581.3971107858334 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 638.4835980718711 622.534597763 L 757.7881845371836 622.534597763 L 772.4898675071836 637.236280733 L 772.4898675071836 660.105565353 L 638.4835980718711 660.105565353 L 638.4835980718711 622.534597763 M 757.7881845371836 622.534597763 L 757.7881845371836 637.236280733 L 772.4898675071836 637.236280733" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="661.3528826918711" y="645.403882383" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set End Time</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 690.7850498195273 684.608370303 L 720.1884157595273 714.011736243 M 720.1884157595273 684.608370303 L 690.7850498195273 714.011736243" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g><rect fill="white" stroke="none" x="230.97934733051954" y="782.6195901029998" width="201.82960762085938" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="233.42962782551953" y="797.3212730729998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Write error to log and continue</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 211.64935675885286 803.8553543929999 L 276.99016995885285 803.8553543929999 L 276.99016995885285 825.0911186829999 L 225.09867414251954 825.0911186829999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(211.64935675885286,825.0911186829999) translate(-211.64935675885286,-825.0911186829999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 225.26202617551954 818.2847839746665 L 211.64935675885286 825.0911186829999 L 225.26202617551954 831.8974533913332 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 154.47614520885287 311.51232693099996 L 780.6574691571834 311.51232693099996 L 780.6574691571834 849.5939236329999 L 154.47614520885287 849.5939236329999 L 154.47614520885287 311.51232693099996 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 154.47614520885287 311.51232693099996 L 154.47614520885287 331.11457089099997 L 200.8353488059232 331.11457089099997 L 210.6364707859232 321.31344891099997 L 210.6364707859232 311.51232693099996 L 154.47614520885287 311.51232693099996" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="170.81134850885286" y="324.580489571" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="224.5213935909232" y="312.819143195" width="233.02241767945313" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="226.97167408592318" y="324.580489571" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[If latest run exists and has no stop time]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 154.47614520885287 738.5145411929999 L 780.6574691571835 738.5145411929999" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray="4.083800825"/></g><g/><g><rect fill="white" stroke="none" x="224.5213935909232" y="739.8213574569999" width="35.54286445679688" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="226.97167408592318" y="751.5827038329999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[else]</text></g><g/></g><g/><g/><g/></g></svg>